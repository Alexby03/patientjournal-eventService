# ==============================================================================
# HTTP & SERVER SETTINGS
# ==============================================================================

quarkus.http.port=8087
quarkus.http.host=0.0.0.0

# ==============================================================================
# CORS CONFIGURATION (Frontend Access)
# ==============================================================================
quarkus.http.cors.enabled=true
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS
quarkus.http.cors.headers=accept,authorization,content-type,x-requested-with
quarkus.http.cors.access-control-allow-credentials=true

%dev.quarkus.http.cors.origins=http://localhost:3000
%prod.quarkus.http.cors.origins=http://patientjournal-frontendreact

# ==============================================================================
# KAFKA CONFIGURATION
# ==============================================================================
# Global settings for the connector
mp.messaging.connector.smallrye-kafka.auto.offset.reset=earliest

# %dev: Connect to localhost (exposed port from Docker)
%dev.kafka.bootstrap.servers=localhost:9094

# %prod: Connect to the internal Cloud service name
%prod.kafka.bootstrap.servers=patientjournal-kafka:9092

# ==============================================================================
# CHANNEL: message-events-in
# This connects the "chat-messages" topic to your "EventListener" class
# ==============================================================================
# 1. Define the connector
mp.messaging.incoming.message-events-in.connector=smallrye-kafka

# 2. Define the physical topic name
mp.messaging.incoming.message-events-in.topic=chat-messages

# 3. Automatic JSON Deserialization (Magic!)
# This turns JSON strings directly into your 'MessageCreatedEvent' Java object

# Use the GENERIC Quarkus deserializer
mp.messaging.incoming.message-events-in.value.deserializer=se.kth.patientjournal.config.MessageCreatedEventDeserializer

# 4. Error Handling (Optional but recommended)
# If a bad JSON message arrives, log it and move on instead of crashing
mp.messaging.incoming.message-events-in.failure-strategy=ignore